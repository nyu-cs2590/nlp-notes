\documentclass[crop,tikz]{standalone}
\usepackage{amstext}
\usepackage{amssymb}
\usetikzlibrary{positioning}
\usetikzlibrary{shapes.misc}

\begin{document}

\include{style}

\begin{tikzpicture}

% bottom layer
\foreach \i in {1,...,3}{
    \node (l1-\i) [vector] at(3.5*\i,0) {$x_{k-\i}$};
    \node (l2-\i) [vector] [above= of l1-\i] {$\phi_\i$};
    \node (l3-\i) [vector] [above= of l2-\i] {$e_\i$};
    \node (l4-\i) [vector] [above= of l3-\i] {$s_\i$};
}

% last layer
\node (top) [vector] [above= of l4-2] {$\text{softmax}(s_1 + s_2 + s_3)$};

% connection
\foreach \i in {1,...,3}{
    \path [arrow] (l1-\i) -- node [right] {$\phi_{\text{one-hot}}(x)$} (l2-\i);
    \path [arrow] (l2-\i) -- node [right] {$\sigma(W_{1\i} \phi)$} (l3-\i);
    \path [arrow] (l3-\i) -- node [right] {$W_{2\i} e$} (l4-\i);
    \path [arrow] (l4-\i) -- (top);
}

% comment
\node (l1-text) [right=2cm of l1-3] {input words};
\node (l2-text) [right=2cm of l2-3] {one-hot embedding};
\node (l3-text) [right=2cm of l3-3] {dense embedding};
\node (l4-text) [right=2cm of l4-3] {class scores};
\node (top-text) [above= of l4-text] {$p(y\mid x)$};

\end{tikzpicture}
\end{document}
